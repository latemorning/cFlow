<?xml version="1.0" encoding="UTF-8"?>
<!--
	수정일        수정자                          수정내용
  =========     =======    =================================================
  2024.07.17   	harry     	 	최초 생성
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="vctnManageDAO">

    <select id="selectVctnManageList" parameterType="egovframework.com.dty.hnr.vct.service.VctnManageVO" resultType="egovframework.com.dty.hnr.vct.service.VctnManageVO">
			   SELECT
	                     A.APPLCNT_ID          AS applcntId        ,
	                     A.VCATN_SE            AS vcatnSe          ,
	                     A.REQST_DE            AS reqstDe          ,
	                     A.VCATN_RESN          AS vcatnResn        ,
	                     A.SANCTNER_ID         AS sanctnerId       ,
						 (select mst.USER_NM from COMVNUSERMASTER mst where  mst.ESNTL_ID = A.SANCTNER_ID)  AS sanctnerNm,
	                     A.CONFM_AT            AS confmAt          ,
	                     A.SANCTN_DT           AS sanctnDt         ,
	                     A.RETURN_RESN         AS returnResn       ,
	                     A.BGNDE               AS bgnde            ,
	                     A.ENDDE               AS endde            ,
	                     A.NOON_SE             AS noonSe           ,
				     (select code_nm from COMTCCMMNDETAILCODE where code_id ='COM056' and code = A.VCATN_SE) AS vcatnSeNm
			   FROM   COMTNVCATNMANAGE A
			   WHERE  1=1
					 AND  BGNDE LIKE CONCAT('%', #{searchKeyword}, '%') <if test="@org.apache.commons.lang3.StringUtils@isNotBlank(applcntId)">
			     AND  APPLCNT_ID = #{applcntId} </if>
			   ORDER BY FRST_REGIST_PNTTM DESC
			   LIMIT #{recordCountPerPage} OFFSET #{firstIndex} 
    </select>

    <select id="selectVctnManageListTotCnt" parameterType="egovframework.com.dty.hnr.vct.service.VctnManageVO" resultType="int">
            SELECT  COUNT(*) totcnt
            FROM    COMTNVCATNMANAGE
            WHERE   1=1
		    AND     BGNDE like CONCAT('%', #{searchKeyword}, '%') <if test="@org.apache.commons.lang3.StringUtils@isNotBlank(applcntId)">
		    AND     APPLCNT_ID = #{applcntId} </if>
    </select>

</mapper>